{
  "id": "nodejs-generic",
  "name": "Node.js Bot (Generic)",
  "description": "Generic Node.js bot/application with git clone and npm install support. Fully customizable via environment variables.",
  "author": "Catalyst Maintainers",
  "version": "1.0.0",
  "image": "node:22-alpine",
  "images": [
    { "name": "node-22", "label": "Node.js 22 (Alpine)", "image": "node:22-alpine" },
    { "name": "node-20", "label": "Node.js 20 (Alpine)", "image": "node:20-alpine" },
    { "name": "node-18", "label": "Node.js 18 (Alpine)", "image": "node:18-alpine" },
    { "name": "node-22-debian", "label": "Node.js 22 (Debian)", "image": "node:22" },
    { "name": "node-20-debian", "label": "Node.js 20 (Debian)", "image": "node:20" },
    { "name": "node-18-debian", "label": "Node.js 18 (Debian)", "image": "node:18" }
  ],
  "defaultImage": "node:22-alpine",
  "startup": "cd {{SERVER_DIR}}; export NODE_ENV={{NODE_ENV}}; [ -n \"{{BOT_TOKEN}}\" ] && export BOT_TOKEN=\"{{BOT_TOKEN}}\"; [ -n \"{{CUSTOM_ENV_1_KEY}}\" ] && export {{CUSTOM_ENV_1_KEY}}=\"{{CUSTOM_ENV_1_VALUE}}\"; [ -n \"{{CUSTOM_ENV_2_KEY}}\" ] && export {{CUSTOM_ENV_2_KEY}}=\"{{CUSTOM_ENV_2_VALUE}}\"; [ -n \"{{CUSTOM_ENV_3_KEY}}\" ] && export {{CUSTOM_ENV_3_KEY}}=\"{{CUSTOM_ENV_3_VALUE}}\"; if [ \"{{AUTO_UPDATE}}\" = \"1\" ]; then git pull 2>/dev/null || true; npm install {{INSTALL_ARGS}} 2>/dev/null || true; fi; exec {{STARTUP_COMMAND}}",
  "stopCommand": "{{STOP_COMMAND}}",
  "sendSignalTo": "SIGTERM",
  "variables": [
    {
      "name": "GIT_REPO",
      "description": "Git repository URL to clone (https or ssh)",
      "default": "",
      "required": true,
      "input": "text"
    },
    {
      "name": "GIT_BRANCH",
      "description": "Git branch to checkout (leave empty for default branch)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "STARTUP_COMMAND",
      "description": "Command to start the bot (e.g., 'npm start' or 'node index.js')",
      "default": "npm start",
      "required": true,
      "input": "text"
    },
    {
      "name": "STOP_COMMAND",
      "description": "Command to gracefully stop the bot (sent to process stdin)",
      "default": "stop",
      "required": false,
      "input": "text"
    },
    {
      "name": "AUTO_UPDATE",
      "description": "Automatically pull latest changes on restart",
      "default": "0",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "INSTALL_ARGS",
      "description": "Additional arguments for npm install (e.g., '--production')",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "NODE_ENV",
      "description": "Node environment (production, development)",
      "default": "production",
      "required": false,
      "input": "select",
      "rules": ["in:production,development"]
    },
    {
      "name": "BOT_TOKEN",
      "description": "Bot authentication token (Discord, Telegram, etc.)",
      "default": "",
      "required": false,
      "input": "password"
    },
    {
      "name": "CUSTOM_ENV_1_KEY",
      "description": "Custom environment variable name (optional)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "CUSTOM_ENV_1_VALUE",
      "description": "Custom environment variable value (optional)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "CUSTOM_ENV_2_KEY",
      "description": "Custom environment variable name (optional)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "CUSTOM_ENV_2_VALUE",
      "description": "Custom environment variable value (optional)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "CUSTOM_ENV_3_KEY",
      "description": "Custom environment variable name (optional)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "CUSTOM_ENV_3_VALUE",
      "description": "Custom environment variable value (optional)",
      "default": "",
      "required": false,
      "input": "text"
    }
  ],
  "installScript": "#!/bin/sh\nset -e\n\necho '[Catalyst] Starting Node.js bot installation...'\n\n# Install git if not present\nif ! command -v git >/dev/null 2>&1; then\n  echo '[Catalyst] Installing git...'\n  apk add --no-cache git 2>/dev/null || apt-get update && apt-get install -y git\nfi\n\n# Create and navigate to server directory\nmkdir -p {{SERVER_DIR}}\ncd {{SERVER_DIR}}\n\n# Clone repository\nif [ -z \"{{GIT_REPO}}\" ]; then\n  echo '[Catalyst] ERROR: GIT_REPO variable is not set'\n  exit 1\nfi\n\necho '[Catalyst] Cloning repository from {{GIT_REPO}}...'\n\n# Remove existing files if present\nrm -rf .git * .[!.]* 2>/dev/null || true\n\n# Clone with or without branch specification\nif [ -n \"{{GIT_BRANCH}}\" ]; then\n  echo '[Catalyst] Cloning branch: {{GIT_BRANCH}}'\n  git clone --depth 1 --branch {{GIT_BRANCH}} {{GIT_REPO}} .\nelse\n  echo '[Catalyst] Cloning default branch'\n  git clone --depth 1 {{GIT_REPO}} .\nfi\n\nif [ ! -f package.json ]; then\n  echo '[Catalyst] ERROR: package.json not found in repository'\n  exit 1\nfi\n\necho '[Catalyst] Repository cloned successfully'\n\n# Install dependencies\necho '[Catalyst] Installing npm dependencies...'\nnpm install {{INSTALL_ARGS}}\n\nif [ $? -ne 0 ]; then\n  echo '[Catalyst] ERROR: npm install failed'\n  exit 1\nfi\n\necho '[Catalyst] Dependencies installed successfully'\necho '[Catalyst] Installation complete!'\n",
  "supportedPorts": [5000],
  "allocatedMemoryMb": 512,
  "allocatedCpuCores": 1,
  "features": {
    "restartOnExit": true
  }
}
